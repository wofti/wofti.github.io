<HTML>
<HEAD>
<TITLE>Important Libraries</TITLE>
</HEAD>

<!--
<BODY BGCOLOR="#C0C0C0" TEXT="#000000">
-->
<BODY BGCOLOR="#000000" TEXT="#bba400"
link="ccddff" vlink="cc0000" alink="ffffff">


<A HREF="../index.html"><H1>Wolfgang Tichy</H1> </A>

<HR>

<H2>Important libraries</H2>

<H3>BLAS and LAPACK</H3>

BLAS contains functions for common linear algebra operations such as vector
addition, scalar multiplication, dot products, linear combinations, and
matrix multiplication.

<P>

LAPACK relies on BLAS to provide more complicated linear algebra routines
for e.g. solving systems of linear equations and linear least squares,
eigenvalue problems, or matrix factorizations such as LU.

<P>

Many different implementations of BLAS and LAPACK exist. A commonly used one
is OpenBLAS, which contains both BLAS and LAPACK in one library file. I.e.
if one uses OpenBLAS it suffices to add
<PRE>
-lopenblas
</PRE>
to link in support for both BLAS and LAPACK functions.

<P>

In other implementations BLAS and LAPACK are in separate libraries and then
one usually adds
<PRE>
-lblas -llapack
</PRE>
to link in support for BLAS and LAPACK functions.


<H3>GSL</H3>

The GNU Scientific Library (GSL) is a numerical library. To use it, one can
add
<PRE>
-lgsl -lgslcblas
</PRE>
In this form it uses the BLAS implementation gslcblas, provided by the GSL
itself. However, since gslcblas is not optimized very well, it is better
to use something like
<PRE>
-lgsl -lopenblas
</PRE>
Then it uses the faster OpenBLAS library.


<H3>UMFPACK</H3>

UMFPACK is a very fast library for finding to LU-decomposition of sparse
matrices. To function it also needs the AMD library, as well as BLAS. I.e.
to compile with UMFPACK we one needs e.g.:
<PRE>
-lumfpack -lamd -lopenblas
</PRE>
Both UMFPACK and AMD are part of the very large
<A HREF="https://github.com/DrTimothyAldenDavis/SuiteSparse/releases">
SuiteSparse</A> package.
However, if you only need UMFPACK (and AMD) you can
also compile it yourself by following the instructions in
<A HREF="https://github.com/wofti/Packages/blob/main/forUMFPACK/Note.txt">
Packages/forUMFPACK/Note.txt</A>.



<HR>

<H2>Using libraries on supercomputers</H2>

As explained in the
<A HREF="../../Software/CompileNotes.html">Compile Notes</A>
one often also needs to specify the exact directories where the libraries
and their include files reside (i.e. the -L and -I options).
If there are several versions of each library, this can get tedious very
quickly. For this reason many supercomputers have a module system, that can
be used to set up the default search locations for the compiler.
E.g. in order to link with OpenBLAS one would simply type
<PRE>
module load openblas
</PRE>
before compiling. Then the -L and -I options do not need to be given, and
configurations such as MyConfig simplify.

<P>

This works because the module system will set the environment variables
LIBRARY_PATH and CPATH that the gcc compiler uses (if no -L or -I are given)
to search for libraries and include files. You can verify that they have
been set with:
<PRE>
echo $LIBRARY_PATH
echo $CPATH
</PRE>

The module system should also set the environment variable
LD_LIBRARY_PATH. LD_LIBRARY_PATH is not directly used by the compiler.
Rather it is used at program start to find all shared libraries that the
program needs. Check it with:
<PRE>
echo $LD_LIBRARY_PATH
</PRE>
If only LD_LIBRARY_PATH is wrong, the compilation will succeed, but when
you start the compiled program, you may get "error while loading shared
libraries".

<P>

Unfortunately, on FAU's Athene supercomputer some of these modules are
broken in the sense that they do not set all required environment variables,
so that one still may need to specify some -L and -I options anyway.

For some libraries we can find out these options using pkg-config. E.g.
<PRE>
pkg-config --libs openblas
pkg-config --cflags openblas
</PRE>
should tell us the locations for openblas. When pkg-config works on Athene,
we can even use
<PRE>
SPECIALLIBS += $(shell pkg-config --libs openblas)
</PRE>
directly in the MyConfig. But on Athene you never know if a module sets up
the environment variables that pkg-config needs, so that pkg-config may fail
as well.


</BODY>
<HTML>
